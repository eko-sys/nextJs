{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport Loader from 'react-loader-spinner';\n\nvar ProductModal = /*#__PURE__*/function (_React$Component) {\n  _inherits(ProductModal, _React$Component);\n\n  var _super = _createSuper(ProductModal);\n\n  function ProductModal(props) {\n    var _this;\n\n    _classCallCheck(this, ProductModal);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      numberTarget: '',\n      productTarget: '',\n      listProduct: null,\n      typeProduct: {\n        provaider_id: null\n      },\n      title: function title() {\n        if (_this.props.type === 'pulsa') {\n          return 'Pulsa';\n        } else if (_this.props.type === 'data') {\n          return \"Paket Data\";\n        } else if (_this.props.type === 'vdata') {\n          return \"Voucher Data\";\n        }\n      },\n      loading: false,\n      buttonVis: false\n    };\n    return _this;\n  }\n\n  _createClass(ProductModal, [{\n    key: \"apiPpob\",\n    value: function apiPpob(provaider) {\n      var _this2 = this;\n\n      var currentUrl = window.location.href;\n      var uriSegment = currentUrl.split('/');\n      var host = uriSegment[2];\n      this.setLoading(true);\n      var apiUrl = \"http://\".concat(host, \"/api/product/pulsa\");\n      fetch(apiUrl, {\n        method: 'get',\n        headers: {\n          \"Authorization\": \"Bearer \".concat(this.props.token)\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (res) {\n        _this2.setState({\n          listProduct: res.data\n        });\n\n        _this2.setLoading(false);\n\n        _this2.setState({\n          typeProduct: {\n            provaider_id: provaider\n          }\n        });\n      });\n    }\n  }, {\n    key: \"orderHandler\",\n    value: function orderHandler() {\n      var _this$state = this.state,\n          productTarget = _this$state.productTarget,\n          numberTarget = _this$state.numberTarget;\n\n      if (numberTarget || productTarget) {\n        this.setState({\n          buttonVis: true\n        });\n        this.apiPpobReqOrder(numberTarget, productTarget);\n      } else {\n        alert('Oops!, nomor atau produk kelupaan :)');\n      }\n    }\n  }, {\n    key: \"apiPpobReqOrder\",\n    value: function apiPpobReqOrder(number, product) {\n      var _this3 = this;\n\n      var currentUrl = window.location.href;\n      var uriSegment = currentUrl.split('/');\n      var host = uriSegment[2];\n      this.setLoading(true);\n      var apiUrl = \"http://\".concat(host, \"/api/product/pulsa/request?action=order&service=\").concat(product, \"&target=\").concat(number);\n      fetch(apiUrl, {\n        method: 'post',\n        headers: {\n          \"Authorization\": \"Bearer \".concat(this.props.token)\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (res) {\n        _this3.setLoading(false);\n\n        _this3.setState({\n          buttonVis: false\n        });\n\n        if (res.result == false) {\n          alert(res.data);\n        } else if (res.status === false) {\n          alert(res.msg);\n        } else {\n          alert('Produk berhasil dibeli laman akan segera dialihkan dalam 3 detik');\n          setTimeout(function () {\n            location.replace('/dashboard/home');\n          }, 3000);\n        }\n      });\n    }\n  }, {\n    key: \"setLoading\",\n    value: function setLoading(val) {\n      this.setState({\n        loading: val\n      });\n    }\n  }, {\n    key: \"onChangeNumber\",\n    value: function onChangeNumber(number) {\n      var three = ['0895', '0896', '0897', '0898', '0899'];\n      var smart = ['0881', '0882', '0883', '0884', '0885', '0886', '0887', '0888', '0889'];\n      var axis = ['0838', '0831', '0832', '0833'];\n      var tsel = ['0811', '0812', '0813', '0821', '0822', '0852', '0853', '0823'];\n      var xl = ['0817', '0818', '0819', '0859', '0877', '0878'];\n      var isat = ['0814', '0815', '0816', '0855', '0856', '0857', '0858'];\n      var byU = ['0851'];\n      var frontNumb = number.target.value.slice(0, 4);\n      this.setState({\n        numberTarget: number.target.value\n      });\n\n      if (three.includes(frontNumb)) {\n        this.apiPpob(3);\n      } else if (smart.includes(frontNumb)) {\n        this.apiPpob(5);\n      } else if (xl.includes(frontNumb)) {\n        this.apiPpob(6);\n      } else if (tsel.includes(frontNumb)) {\n        this.apiPpob(1);\n      } else if (isat.includes(frontNumb)) {\n        this.apiPpob(2);\n      } else if (axis.includes(frontNumb)) {\n        this.apiPpob(4);\n      } else if (byU.includes(frontNumb)) {\n        this.apiPpob(7);\n      }\n    }\n  }, {\n    key: \"onChangeSelect\",\n    value: function onChangeSelect(e) {\n      this.setState({\n        productTarget: e.target.value\n      });\n    }\n  }, {\n    key: \"toRpID\",\n    value: function toRpID(value) {\n      var reverse = value.toString().split('').reverse().join(''),\n          ribuan = reverse.match(/\\d{1,3}/g);\n      ribuan = ribuan.join('.').split('').reverse().join('');\n      return ribuan;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return __jsx(\"div\", {\n        className: \"modal fade\",\n        id: \"productModal\",\n        tabIndex: \"-1\",\n        role: \"dialog\",\n        \"aria-labelledby\": \"exampleModalLabel\",\n        \"aria-hidden\": \"true\"\n      }, __jsx(\"div\", {\n        className: \"modal-dialog modal-dialog-centered\",\n        role: \"document\"\n      }, __jsx(\"div\", {\n        className: \"modal-content\"\n      }, __jsx(\"div\", {\n        className: \"modal-header\"\n      }, __jsx(\"h5\", {\n        className: \"modal-title\",\n        id: \"exampleModalLabel\"\n      }, this.state.title()), __jsx(\"button\", {\n        type: \"button\",\n        className: \"close\",\n        \"data-dismiss\": \"modal\",\n        \"aria-label\": \"Close\"\n      }, __jsx(\"span\", {\n        \"aria-hidden\": \"true\"\n      }, \"\\xD7\"))), __jsx(\"div\", {\n        className: \"modal-body\"\n      }, __jsx(\"div\", {\n        className: \"form-group mb-3\"\n      }, __jsx(\"div\", {\n        className: \"input-group input-group-merge input-group-alternative\"\n      }, __jsx(\"div\", {\n        className: \"input-group-prepend\"\n      }, __jsx(\"span\", {\n        className: \"input-group-text\"\n      }, __jsx(\"i\", {\n        className: \"ni ni-email-83\"\n      }))), __jsx(\"input\", {\n        value: this.state.numberTarget,\n        className: \"form-control\",\n        onChange: function onChange(e) {\n          _this4.onChangeNumber(e);\n        },\n        placeholder: \"No Tujuan\",\n        type: \"number\",\n        required: true\n      }))), __jsx(\"div\", {\n        className: \"form-group\"\n      }, __jsx(\"div\", {\n        className: \"input-group input-group-merge input-group-alternative\"\n      }, __jsx(\"div\", {\n        className: \"input-group-prepend\"\n      }, __jsx(\"span\", {\n        className: \"input-group-text\"\n      }, __jsx(\"i\", {\n        className: \"ni ni-email-83\"\n      }))), __jsx(\"select\", {\n        value: this.state.productTarget,\n        onChange: function onChange(e) {\n          _this4.onChangeSelect(e);\n        },\n        className: \"form-control\"\n      }, this.state.listProduct ? __jsx(React.Fragment, null, __jsx(\"option\", {\n        value: \"\"\n      }, \"Pilih Product\"), this.state.listProduct.map(function (data) {\n        if (data.provaider_id == _this4.state.typeProduct.provaider_id && data.type == _this4.props.type) {\n          return __jsx(\"option\", {\n            value: data.product_code\n          }, data.product_name);\n        }\n      })) : __jsx(\"option\", null, \"Service unrecognized\"))))), __jsx(\"div\", {\n        className: \"text-center\"\n      }, this.state.productTarget ? this.state.listProduct.map(function (data) {\n        if (_this4.state.productTarget == data.product_code) {\n          return __jsx(\"div\", null, __jsx(\"h5\", null, data.note), __jsx(\"h5\", null, \"Harga: \", _this4.toRpID(data.price)));\n        }\n      }) : null), __jsx(\"div\", {\n        className: \"modal-footer\"\n      }, __jsx(\"button\", {\n        type: \"button\",\n        className: \"btn btn-secondary\",\n        \"data-dismiss\": \"modal\"\n      }, \"Tutup\"), __jsx(\"button\", {\n        type: \"button\",\n        onClick: function onClick() {\n          _this4.orderHandler();\n        },\n        className: \"btn btn-primary\",\n        disabled: this.state.buttonVis\n      }, \"Beli\")))), this.state.loading ? __jsx(\"div\", {\n        className: \"fixed-bottom d-flex justify-content-center\"\n      }, __jsx(Loader, {\n        type: \"ThreeDots\",\n        color: \"#ffff00\",\n        height: 70,\n        width: 70\n      })) : null);\n    }\n  }]);\n\n  return ProductModal;\n}(React.Component);\n\nexport default ProductModal;","map":null,"metadata":{},"sourceType":"module"}